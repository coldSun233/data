rate_tensor = generate_main